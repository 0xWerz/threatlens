<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ThreatLens | Custom PR Guardrails</title>
    <meta
      name="description"
      content="ThreatLens scans pull request diffs for risky security regressions with custom policy packs built for your team."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Instrument+Sans:wght@400;500;700&family=IBM+Plex+Mono:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="noise"></div>
    <header class="hero">
      <p class="eyebrow">PR Security Guardrails, Without Platform Bloat</p>
      <h1>
        ThreatLens
        <span>for custom business-logic checks</span>
      </h1>
      <p class="hero-copy">
        Generic scanners catch generic bugs. ThreatLens focuses on risky diffs your
        team actually ships: auth bypass toggles, weak redirect paths, risky egress,
        and custom policy rules you can tune.
      </p>
      <div class="hero-tags">
        <span>Diff-first</span>
        <span>Policy packs</span>
        <span>CI ready</span>
      </div>
    </header>

    <main class="layout">
      <section class="panel control-panel">
        <div class="panel-head">
          <h2>Run a scan</h2>
          <p>Paste a unified diff and run the active pack.</p>
        </div>

        <form id="scan-form" class="scan-form">
          <label for="pack">Policy pack</label>
          <select id="pack" name="pack"></select>

          <label for="failOn">Fail threshold</label>
          <select id="failOn" name="failOn">
            <option value="none">none (report-only)</option>
            <option value="low">low</option>
            <option value="medium">medium</option>
            <option value="high" selected>high</option>
          </select>

          <label for="llmMode">LLM advisory</label>
          <select id="llmMode" name="llmMode">
            <option value="off" selected>off</option>
            <option value="auto">auto (recommended)</option>
            <option value="always">always</option>
          </select>

          <label for="diff">Unified diff</label>
          <textarea
            id="diff"
            name="diff"
            placeholder="Paste git diff output here..."
            spellcheck="false"
            required
          ></textarea>

          <div class="actions">
            <button type="submit" id="scan-btn">Scan diff</button>
            <button type="button" id="sample-btn" class="ghost">Load sample</button>
          </div>
        </form>
      </section>

      <section class="panel results-panel">
        <div class="panel-head">
          <h2>Findings</h2>
          <p id="scan-meta">No scan yet.</p>
        </div>

        <div id="summary" class="summary hidden"></div>
        <div id="findings" class="findings"></div>
      </section>
    </main>

    <section class="proof-strip">
      <article>
        <h3>What this is</h3>
        <p>
          A practical guardrail layer designed to run in pull requests, not a full
          static analysis replacement.
        </p>
      </article>
      <article>
        <h3>Who it fits</h3>
        <p>
          Teams with limited AppSec bandwidth that still need strict checks on
          authz, data boundaries, and risky runtime config changes.
        </p>
      </article>
      <article>
        <h3>How to extend</h3>
        <p>
          Add or suppress rule IDs by policy pack and wire scanner output to CI
          block rules.
        </p>
      </article>
    </section>

    <script type="module" src="/app.js"></script>
  </body>
</html>
